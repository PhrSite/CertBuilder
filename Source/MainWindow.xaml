<Window x:Class="CertBuilder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CertBuilder"
        mc:Ignorable="d"
        Title="NG9-1-1 Certificate Builder" Height="600" Width="500" FontSize="16" 
        WindowStartupLocation="CenterScreen" ResizeMode="CanMinimize">
    <Grid Name="MainGrid" Background="AliceBlue">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="23*"/>
            <ColumnDefinition Width="289*"/>
            <ColumnDefinition Width="188*"/>
        </Grid.ColumnDefinitions>
        <!--
        <Grid.Resources>
            <local:CertBuilderSettings x:Key="settings"></local:CertBuilderSettings>
        </Grid.Resources>
        <Grid.DataContext>
            <Binding Source="{StaticResource settings}"/>
        </Grid.DataContext>
        -->
        <Grid.RowDefinitions>
            <RowDefinition Height="9*"></RowDefinition>
            <RowDefinition Height="1*"></RowDefinition>
        </Grid.RowDefinitions>
        <TabControl Name = "TabCtrl" Grid.Row="0" Grid.ColumnSpan="3" Margin="0,0,0,58" Grid.RowSpan="2">
            <TabItem Header="General">
                <StackPanel Orientation="Vertical" Margin="10, 30, 10, 10">
                    <StackPanel Orientation="Horizontal">
                        <CheckBox Name="SelfSignedCheckBox" Content="Self-Signed Certificate" IsChecked="{Binding Path=selfSigned}" Click="OnSelfSignedCheckBoxClicked"></CheckBox>
                        <CheckBox Content="Certificate Authority Certificate" Margin="20,0,9,9"
                            IsChecked="{Binding Path=caCertificate}"></CheckBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0, 30,0,0">
                        <Label Content="Signing Algorithm"></Label>
                        <ComboBox Width="100" Margin="10,0,0,0" 
                            SelectedIndex="{Binding Path=signingAlgorithmIdx}" IsReadOnly="True">
                            <ComboBoxItem>RSA</ComboBoxItem>
                            <ComboBoxItem>ECDSA</ComboBoxItem>
                        </ComboBox>
                        <Label Content="Expires (years)" Margin="10,0,0,0"></Label>
                        <TextBox x:Name="Expires" Width="60" Margin="10,0,0,0" Text="{Binding expiresYears, Mode=TwoWay}"></TextBox>
                    </StackPanel>
                    <StackPanel Name="CaStackPanel" Orientation="Vertical" Margin="0,30,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="Certificate Authority (CA) Certificate File"></Label>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Name="CaCert" Width="390" Text="{Binding caCertFile, Mode=TwoWay}"></TextBox>
                            <Button Name="CaCertBrowse" Click="OnCaCertBrowse" Content="Browse" Margin="5,0,0,0"></Button>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Margin="0,30,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="New Certificate Destination Directory"></Label>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Name="DestDir" Width="390" Text="{Binding destinationDirectory, Mode=TwoWay}"></TextBox>
                            <Button Name="DestDirBrowse" Click="OnDestDirBrowse" Content="Browse" Margin="5,0,0,0"></Button>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,30,0,0">
                        <Label Content="New Certificate File Name (No Extension)"></Label>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" >
                        <TextBox Width="390" Margin="5,0,0,0" 
                            Text="{Binding Path=fileNameNoExtension, Mode=TwoWay}"></TextBox>
                    </StackPanel>
                </StackPanel>
            </TabItem>
            <TabItem Header="Subject Distinguished Name">
                <Grid VerticalAlignment="Top" Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"></ColumnDefinition>
                        <ColumnDefinition Width="4*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                        <RowDefinition Height="45"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Label Content="Common Name" Grid.Row="0" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Name ="CommonName" Grid.Row="0" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.commonName}"></TextBox>

                    <Label Content="Domain Name" Grid.Row="1" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="1" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.domainComponent}"></TextBox>

                    <Label Content="Organization Name" Grid.Row="2" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="2" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.organizationName}"></TextBox>

                    <Label Content="Organization Unit" Grid.Row="3" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="3" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.organizationalUnitName}"></TextBox>

                    <Label Content="E-mail Address" Grid.Row="4" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="4" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.emailAddress}"></TextBox>

                    <Label Content="City" Grid.Row="5" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="5" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.localityOrCityName}"></TextBox>

                    <Label Content="State" Grid.Row="6" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="6" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.stateOrProvinceName}"></TextBox>

                    <Label Content="Country or Region" Grid.Row="7" Grid.Column="0" Margin="0,0,0,10"></Label>
                    <TextBox Grid.Row="7" Grid.Column="1" Margin="0,0,0,10"
                        Text="{Binding nameParams.countryOrRegion}"></TextBox>
                </Grid>
            </TabItem>
            <TabItem Header="Key Usage">
                <StackPanel Orientation="Vertical" Margin="20">
                    <CheckBox Content="CRL Signing" Margin="5" IsChecked="{Binding usageParams.crlSign}"></CheckBox>
                    <CheckBox Content="Data Encipherment" Margin="5" IsChecked="{Binding usageParams.dataEncipherment}"></CheckBox>
                    <CheckBox Content="Decipher Only" Margin="5" IsChecked="{Binding usageParams.decipherOnly}"></CheckBox>
                    <CheckBox Content="Digital Signature" Margin="5" IsChecked="{Binding usageParams.digitalSignature}"></CheckBox>
                    <CheckBox Content="Code Signing" Margin="5" IsChecked="{Binding usageParams.codeSigning}"></CheckBox>
                    <CheckBox Content="Encipher Only" Margin="5" IsChecked="{Binding usageParams.encipherOnly}"></CheckBox>
                    <CheckBox Content="Key Agreement" Margin="5" IsChecked="{Binding usageParams.keyAgreement}"></CheckBox>
                    <CheckBox Content="Key Certificate Signing" Margin="5" IsChecked="{Binding usageParams.keyCertSign}"></CheckBox>
                    <CheckBox Content="Key Encipherment" Margin="5" IsChecked="{Binding usageParams.keyEncipherment}"></CheckBox>
                    <CheckBox Content="Non-Repudiation" Margin="5" IsChecked="{Binding usageParams.nonRepudiation}"></CheckBox>
                    <CheckBox Content="Server Authentication" Margin="5" IsChecked="{Binding usageParams.serverAuthentication}"></CheckBox>
                    <CheckBox Content="Client Authentication" Margin="5" IsChecked="{Binding usageParams.clientAuthentication}"></CheckBox>
                </StackPanel>
            </TabItem>
            <TabItem Header="SubAltName">
                <StackPanel Orientation="Vertical" Margin="0,10,0,0">
                    <StackPanel Orientation="Horizontal" Margin="0, 10,0,0">
                        <CheckBox Content="Add NG9-1-1 Subject Alternate Name Extension"
                            IsChecked="{Binding addNg911SubjectAltName}"></CheckBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                        <Label Content="ID Type"></Label>
                        <ComboBox Name ="IdTypeCombo" Width="100" IsReadOnly="True" ItemsSource="{Binding idTypes}"
                            SelectedItem="{Binding sanParams.idType, Mode=TwoWay}" >
                        </ComboBox>
                        <Label Content="ID" Margin="10,0,0,0"></Label>
                        <TextBox Name="IdTextBox" Width="200" Text="{Binding sanParams.iD}"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <Label Content="Owner"></Label>
                        <TextBox Width="335" Margin="5,0,0,0"></TextBox>
                    </StackPanel>
                    <DockPanel Height="280" Margin="0,10,0,0">
                        <Label Content="Assigned Roles" DockPanel.Dock="Top"></Label>
                        <ListBox Name="RolesLb" DockPanel.Dock="Top"></ListBox>
                    </DockPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="Add" Click="OnAddRole"></Button>
                        <Button Content="Delete" Margin="10,0,0,0" Click="OnDeleteRole"></Button>
                        <Button Content="Clear" Margin="10,0,0,0" Click="OnClearRoles"></Button>
                    </StackPanel>
                </StackPanel>

            </TabItem>
        </TabControl>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Grid.ColumnSpan="3">
            <Button Content="Create Certificate" Click="OnCreateCertificate" Width="140" Height="30" Margin="5"></Button>
            <Button Content="Save Settings" Click="OnSaveSettings" Width="140" Height="30" Margin="5"></Button>
            <Button Content="Help" Width="80" Height="30" Margin="5" Click="OnHelpClicked"></Button>
            <Button Content="Exit" Width="60" Height="30" Margin="5" Click="OnExit"></Button>
        </StackPanel>
    </Grid>
</Window>
